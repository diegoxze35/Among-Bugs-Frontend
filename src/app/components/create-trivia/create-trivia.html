<div class="container pb-5 mt-4">
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <div class="card shadow-lg border rounded-4">
        <div class="card-header p-4">
          <h2 class="h4 mb-0 fw-bold">PANEL DE CONFIGURACIÓN DE TRIVIA</h2>
        </div>

        <div class="card-body p-4 p-md-5">
          <div class="row g-4 mb-5">
            <div class="col-md-8">
              <label class="form-label small fw-bold text-secondary">TÍTULO DE LA TRIVIA (Max 50)</label>
              <input [(ngModel)]="trivia.title" class="form-control" maxlength="50">
            </div>
            <div class="col-md-4">
              <label class="form-label small fw-bold text-secondary">PRIVACIDAD</label>
              <select [(ngModel)]="trivia.isPublic" class="form-select">
                <option [ngValue]="true">Pública</option>
                <option [ngValue]="false">Privada</option>
              </select>
            </div>
            <div class="col-12">
              <label class="form-label small fw-bold text-secondary">DESCRIPCIÓN (Max 200)</label>
              <textarea [(ngModel)]="trivia.description" class="form-control" rows="2" maxlength="200" placeholder="Describe de qué trata tu trivia..."></textarea>
            </div>
          </div>

          <hr class="border-secondary opacity-50 mb-5">

          <div class="d-flex justify-content-between align-items-center mb-4">
            <h3 class="h5 fw-bold text-info mb-0"> PREGUNTAS Y TRAMPAS</h3>
            <button (click)="addQuestion()" class="btn btn-outline-info btn-sm">
              <i class="bi bi-plus-circle"></i> Agregar pregunta
            </button>
          </div>

          <div *ngFor="let q of trivia.questions; let i = index" class="card border mb-4 shadow-sm">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <span class="badge text-uppercase small fw-bold" style="background-color: #1f2937; color: #f3f4f6; font-size: 0.9rem;">
                  <i class="bi bi-question-circle"></i> PREGUNTA #{{ i + 1 }}
                </span>
                <button
                  (click)="removeQuestion(i)"
                  class="btn btn-outline-danger btn-sm"
                  *ngIf="trivia.questions.length > 1"
                  title="Eliminar pregunta">
                  <i class="bi bi-trash"></i>
                </button>
              </div>

              <div class="mb-3">
                <label class="form-label small fw-bold text-secondary">TEXTO DE LA PREGUNTA</label>
                <input [(ngModel)]="q.questionText" class="form-control form-control-lg" placeholder="Escribe la pregunta aquí..." maxlength="200">
              </div>

              <div class="row g-3 mb-3">
                <div class="col-md-6">
                  <label class="form-label small fw-bold" style="color: #1f2937;">
                    <i class="bi bi-clock"></i> TIEMPO LÍMITE
                  </label>
                  <select [(ngModel)]="q.timeLimit" class="form-select">
                    <option *ngFor="let time of timeLimitOptions" [ngValue]="time">
                      {{ time }} segundos
                    </option>
                  </select>
                </div>
                <div class="col-md-6">
                  <label class="form-label small fw-bold" style="color: #dc2626;">
                    <i class="bi bi-bug-fill"></i> TRAMPA (OPCIONAL)
                  </label>
                  <select [(ngModel)]="q.trickType" class="form-select">
                    <option *ngFor="let trick of trickOptions" [ngValue]="trick.value">
                      {{ trick.label }}
                    </option>
                  </select>
                  <small class="text-muted">Las trampas dificultan la pregunta para el jugador</small>
                </div>
              </div>

              <label class="form-label small fw-bold text-secondary mb-2">OPCIONES DE RESPUESTA</label>
              <div class="row g-2 mb-2">
                <div *ngFor="let opt of q.options; let j = index" class="col-md-6">
                  <div class="input-group">
                    <div class="input-group-text bg-light">
                      <input
                        class="form-check-input mt-0"
                        type="radio"
                        [name]="'correct' + i"
                        [checked]="opt.isCorrect"
                        (change)="markAsCorrect(i, j)"
                        title="Marcar como correcta">
                    </div>
                    <input [(ngModel)]="opt.text" class="form-control" placeholder="Opción {{ j + 1 }}" maxlength="100">
                    <button
                      *ngIf="q.options.length > 2"
                      class="btn btn-outline-danger btn-sm"
                      (click)="removeOption(i, j)"
                      title="Eliminar opción">
                      <i class="bi bi-x-lg"></i>
                    </button>
                  </div>
                </div>
              </div>
              <button
                (click)="addOption(i)"
                class="btn btn-link btn-sm text-info text-decoration-none"
                [disabled]="q.options.length >= 4">
                <i class="bi bi-plus-circle"></i> Añadir otra opción (máx. 4)
              </button>
            </div>
          </div>

          <div class="d-flex justify-content-end gap-3 mt-5">
            <button routerLink="/home" class="btn btn-outline-secondary px-4">
              <i class="bi bi-x-circle"></i> CANCELAR
            </button>
            <button (click)="onCreate()" class="btn btn-primary px-5 fw-bold shadow">
              <i class="bi bi-check-circle"></i> CREAR TRIVIA
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
